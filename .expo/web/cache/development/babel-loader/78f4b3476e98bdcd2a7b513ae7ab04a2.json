{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/mnt/c/Users/SBS31/OneDrive/Desktop/real-SD/MiSu-v2/screens/Application/HomeScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ToastAndroid from \"react-native-web/dist/exports/ToastAndroid\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Icon from \"@expo/vector-icons/Entypo\";\nimport AppHeaderText from \"../../components/app/AppHeaderText\";\nimport AppText from \"../../components/app/AppText\";\nimport HomeCard from \"../../components/cards/HomeCard\";\nimport HubCard from \"../../components/cards/HubCard\";\nimport LogCard from \"../../components/cards/LogCard\";\nimport ShareModal from \"../../components/modals/ShareModal\";\nimport appStyle from \"../../styles/AppStyle\";\n\nvar AWS = require('aws-sdk');\n\nAWS.config.update({\n  region: 'us-east-1'\n});\n\nvar HomeScreen = function (_React$Component) {\n  _inherits(HomeScreen, _React$Component);\n\n  var _super = _createSuper(HomeScreen);\n\n  function HomeScreen(props) {\n    var _this;\n\n    _classCallCheck(this, HomeScreen);\n\n    _this = _super.call(this, props);\n\n    _this.showToast = function (text) {\n      ToastAndroid.show(text, ToastAndroid.LONG);\n    };\n\n    _this.onRefresh = function _callee() {\n      var idToken;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(_this.setState({\n                loading: true\n              }));\n\n            case 2:\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(_this.setState({\n                refreshingUsers: true\n              }));\n\n            case 4:\n              idToken = _this.props.sessionData.idToken;\n\n              _this.props.getHub(idToken);\n\n              _this.props.getDevices(idToken);\n\n              _context.next = 9;\n              return _regeneratorRuntime.awrap(_this.props.getAccounts(idToken));\n\n            case 9:\n              _this.props.getSharedDevices(idToken);\n\n              _this.getUsageLogs();\n\n              _this.getAccessLogs();\n\n              _context.next = 14;\n              return _regeneratorRuntime.awrap(_this.setState({\n                loading: false\n              }));\n\n            case 14:\n              _context.next = 16;\n              return _regeneratorRuntime.awrap(_this.setState({\n                refreshingUsers: false\n              }));\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.getUsageLogs = function _callee2() {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(fetch('https://c8zta83ta5.execute-api.us-east-1.amazonaws.com/test/getusagelogs', {\n                method: 'GET',\n                headers: {\n                  Authorization: 'Bearer ' + _this.props.sessionData.idToken\n                }\n              }).then(function (response) {\n                return response.json();\n              }).then(function (data) {\n                if (data.message.length > 0) {\n                  var sortedLogs = data.message.sort(function (a, b) {\n                    return a.date < b.date ? 1 : a.date === b.date ? a.time < b.time ? 1 : -1 : -1;\n                  });\n\n                  _this.setState({\n                    usageLogs: sortedLogs\n                  });\n                }\n              }).catch(function (error) {\n                _this.showToast(error);\n\n                _this.setState({\n                  error: error\n                });\n              }));\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.getAccessLogs = function _callee3() {\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(fetch('https://c8zta83ta5.execute-api.us-east-1.amazonaws.com/test/getaccesslogs', {\n                method: 'GET',\n                headers: {\n                  Authorization: 'Bearer ' + _this.props.sessionData.idToken\n                }\n              }).then(function (response) {\n                return response.json();\n              }).then(function (data) {\n                if (data.message.length > 0) {\n                  var sortedLogs = data.message.sort(function (a, b) {\n                    return a.date < b.date ? 1 : a.date === b.date ? a.time < b.time ? 1 : -1 : -1;\n                  });\n\n                  _this.setState({\n                    accessLogs: sortedLogs\n                  });\n                }\n              }).catch(function (error) {\n                _this.showToast(error);\n\n                _this.setState({\n                  error: error\n                });\n              }));\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.state = {\n      error: null,\n      message: null,\n      selectedProperties: 0,\n      refreshing: false,\n      loading: false,\n      ref: false,\n      refresh: false,\n      usageLogs: [],\n      accessLogs: []\n    };\n    _this.ModalRef = React.createRef();\n    return _this;\n  }\n\n  _createClass(HomeScreen, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.sessionData != null) this.props.navigation.setParams({\n        name: this.props.sessionData.name\n      });\n      this.onRefresh();\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(props) {\n      this.setState({\n        refresh: !this.state.refresh\n      });\n\n      if (!this.state.loading && props.updateInviteState.loading || !this.state.loading && props.exitHubData.loading || !this.state.loading && props.shareState.loading || !this.state.loading && props.exitHubData.loading) {\n        this.setState({\n          loading: true\n        });\n      }\n\n      if (this.state.loading && !props.shareState.loading && !props.exitHubData.loading && !props.updateInviteState.loading) {\n        this.setState({\n          loading: false\n        });\n      }\n    }\n  }, {\n    key: \"openModal\",\n    value: function openModal() {\n      this.ModalRef.current.snapTo(0);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var newUserScreen = null;\n      var noLogs = null;\n\n      if ((this.props.hubInfoData.hub_email == null || this.props.hubInfoData.hub_email == '') && this.state.loading == false && (this.props.sharedDevicesData == null || this.props.sharedDevicesData.devices == null || this.props.sharedDevicesData.devices.length <= 0)) {\n        newUserScreen = React.createElement(View, {\n          style: appStyle.container,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 5\n          }\n        }, React.createElement(View, {\n          style: {\n            width: 240,\n            alignItems: 'center'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 6\n          }\n        }, React.createElement(AppHeaderText, {\n          style: {\n            marginTop: 20\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 7\n          }\n        }, \"Own a Hub?\"), React.createElement(TouchableOpacity, {\n          style: appStyle.regularButton,\n          onPress: function onPress() {\n            return _this2.props.navigation.navigate('Account');\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 7\n          }\n        }, React.createElement(AppText, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 8\n          }\n        }, \"Register my Hub\")), React.createElement(AppText, {\n          style: {\n            marginTop: 20,\n            fontSize: 16\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 7\n          }\n        }, \"If you own a hub, register above.\"), React.createElement(AppText, {\n          style: {\n            marginTop: 5,\n            fontSize: 15\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 7\n          }\n        }, \"Otherwise, ask a Hub owner to give you access using your User ID,\")), React.createElement(AppText, {\n          style: {\n            marginTop: 5,\n            fontSize: 15\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 6\n          }\n        }, React.createElement(AppText, {\n          style: {\n            fontWeight: 'bold'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 7\n          }\n        }, \" \", this.props.sessionData.email, \" \"), ' '));\n      } else {\n        if (this.state.usageLogs.length <= 0 && this.state.accessLogs.length <= 0) {\n          noLogs = React.createElement(View, {\n            style: appStyle.card,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 6\n            }\n          }, React.createElement(View, {\n            style: [appStyle.container, {\n              paddingBottom: 0,\n              flex: 1\n            }],\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 7\n            }\n          }, React.createElement(View, {\n            style: appStyle.rowLeft,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 175,\n              columnNumber: 8\n            }\n          }, React.createElement(Image, {\n            style: {\n              width: 30,\n              height: 30,\n              marginRight: 20\n            },\n            source: require(\"../../assets/log.png\"),\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 9\n            }\n          }), React.createElement(AppHeaderText, {\n            style: {\n              fontSize: 20,\n              marginTop: 2,\n              marginLeft: -5\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 9\n            }\n          }, \"No Logs Yet...\"))));\n        }\n      }\n\n      return React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 4\n        }\n      }, React.createElement(ScrollView, {\n        style: {\n          flex: 1\n        },\n        refreshControl: React.createElement(RefreshControl, {\n          refreshing: this.state.refreshing,\n          onRefresh: this.onRefresh,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 22\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 5\n        }\n      }, this.state.refreshing == false && React.createElement(View, {\n        style: [appStyle.container, {\n          flex: 1\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 7\n        }\n      }, this.props.hubInfoData.hub_email != null && this.props.hubInfoData.hub_email != '' && React.createElement(HubCard, {\n        name: this.props.sessionData.name,\n        sharedAccounts: this.props.sharedAccountsData.sharedAccounts,\n        loading: this.state.refreshingUsers,\n        OpenModal: this.openModal.bind(this),\n        navigation: this.props.navigation,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 9\n        }\n      }), this.props.sharedDevicesData.devices && Array.isArray(this.props.sharedDevicesData.devices) ? this.props.sharedDevicesData.devices.map(function (device, index) {\n        return React.createElement(HomeCard, {\n          key: index,\n          loading: _this2.props.exitHubData.loading || _this2.props.updateInviteState.loading,\n          sharedDevice: device,\n          navigation: _this2.props.navigation,\n          exitHub: _this2.props.exitHub,\n          updateInvite: _this2.props.updateInvite,\n          IdToken: _this2.props.sessionData.idToken,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 12\n          }\n        });\n      }) : null, noLogs, this.state.usageLogs.length > 0 ? React.createElement(View, {\n        style: [appStyle.container, {\n          padding: 0,\n          flex: 1,\n          alignSelf: 'stretch'\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 9\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: {\n          alignSelf: 'stretch'\n        },\n        onPress: function onPress() {\n          return _this2.props.navigation.navigate('Log');\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 10\n        }\n      }, React.createElement(LogCard, {\n        type: \"Activity\",\n        logs: this.state.usageLogs.slice(0, 5),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }\n      }))) : null, this.state.accessLogs.length > 0 ? React.createElement(View, {\n        style: [appStyle.container, {\n          padding: 0,\n          flex: 1,\n          alignSelf: 'stretch'\n        }],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 9\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: {\n          alignSelf: 'stretch'\n        },\n        onPress: function onPress() {\n          return _this2.props.navigation.navigate('Log');\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 10\n        }\n      }, React.createElement(LogCard, {\n        type: \"Access\",\n        logs: this.state.accessLogs.slice(0, 5),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }\n      }))) : null), newUserScreen, this.state.error && React.createElement(Text, {\n        style: {\n          color: 'red',\n          alignSelf: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 27\n        }\n      }, this.state.error), this.state.message && React.createElement(Text, {\n        style: {\n          color: 'black',\n          alignSelf: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 7\n        }\n      }, this.state.message)), React.createElement(ShareModal, {\n        onRefresh: this.onRefresh,\n        ModalRef: this.ModalRef,\n        setLoadingTrue: this.props.setLoadingTrue,\n        setLoadingFalse: this.props.setLoadingFalse,\n        canEditUser: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 5\n        }\n      }));\n    }\n  }]);\n\n  return HomeScreen;\n}(React.Component);\n\nHomeScreen.navigationOptions = function (_ref) {\n  var navigate = _ref.navigate,\n      navigation = _ref.navigation;\n  return {\n    headerTitle: 'Home',\n    headerRight: function headerRight() {\n      return React.createElement(View, {\n        __self: HomeScreen,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 4\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: {\n          alignSelf: 'center',\n          marginTop: 16\n        },\n        onPress: function onPress() {\n          return navigation.navigate('Account');\n        },\n        __self: HomeScreen,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 26,\n          columnNumber: 5\n        }\n      }, React.createElement(Icon, {\n        name: \"menu\",\n        size: 35,\n        style: {\n          marginLeft: 16,\n          marginRight: 16,\n          marginBottom: 0,\n          bottom: 5\n        },\n        __self: HomeScreen,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 6\n        }\n      }), React.createElement(Text, {\n        style: {\n          fontSize: 18,\n          top: 0,\n          right: 55,\n          textAlign: 'right',\n          fontWeight: 'bold',\n          position: 'absolute',\n          width: 200\n        },\n        __self: HomeScreen,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 6\n        }\n      }, navigation.getParam('name') != null ? navigation.getParam('name').slice(0, 18) : '...')));\n    },\n    headerLeft: function headerLeft() {\n      return React.createElement(View, {\n        __self: HomeScreen,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 4\n        }\n      }, React.createElement(Image, {\n        style: [{\n          marginBottom: -5,\n          marginLeft: 10,\n          width: 64,\n          height: 64\n        }],\n        source: require(\"../../assets/MISU.png\"),\n        __self: HomeScreen,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 5\n        }\n      }));\n    }\n  };\n};\n\nexport default HomeScreen;","map":{"version":3,"sources":["/mnt/c/Users/SBS31/OneDrive/Desktop/real-SD/MiSu-v2/screens/Application/HomeScreen.js"],"names":["React","Icon","AppHeaderText","AppText","HomeCard","HubCard","LogCard","ShareModal","appStyle","AWS","require","config","update","region","HomeScreen","props","showToast","text","ToastAndroid","show","LONG","onRefresh","setState","loading","refreshingUsers","idToken","sessionData","getHub","getDevices","getAccounts","getSharedDevices","getUsageLogs","getAccessLogs","fetch","method","headers","Authorization","then","response","json","data","message","length","sortedLogs","sort","a","b","date","time","usageLogs","catch","error","accessLogs","state","selectedProperties","refreshing","ref","refresh","ModalRef","createRef","navigation","setParams","name","updateInviteState","exitHubData","shareState","current","snapTo","newUserScreen","noLogs","hubInfoData","hub_email","sharedDevicesData","devices","container","width","alignItems","marginTop","regularButton","navigate","fontSize","fontWeight","email","card","paddingBottom","flex","rowLeft","height","marginRight","marginLeft","sharedAccountsData","sharedAccounts","openModal","bind","Array","isArray","map","device","index","exitHub","updateInvite","padding","alignSelf","slice","color","setLoadingTrue","setLoadingFalse","Component","navigationOptions","headerTitle","headerRight","marginBottom","bottom","top","right","textAlign","position","getParam","headerLeft"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { RefreshControl, ScrollView, Text, TouchableOpacity, ToastAndroid, View, Image } from 'react-native';\nimport Icon from 'react-native-vector-icons/Entypo';\nimport AppHeaderText from '../../components/app/AppHeaderText';\nimport AppText from '../../components/app/AppText';\nimport HomeCard from '../../components/cards/HomeCard';\nimport HubCard from '../../components/cards/HubCard';\nimport LogCard from '../../components/cards/LogCard';\nimport ShareModal from '../../components/modals/ShareModal';\nimport appStyle from '../../styles/AppStyle';\n\n// AWS Config\nconst AWS = require('aws-sdk');\nAWS.config.update({ region: 'us-east-1' });\n\nclass HomeScreen extends React.Component {\n\tshowToast = (text) => {\n\t\tToastAndroid.show(text, ToastAndroid.LONG);\n\t};\n\n\t// This might be able to be deleted\n\tstatic navigationOptions = ({ navigate, navigation }) => ({\n\t\theaderTitle: 'Home',\n\t\theaderRight: () => (\n\t\t\t<View>\n\t\t\t\t<TouchableOpacity\n\t\t\t\t\tstyle={{ alignSelf: 'center', marginTop: 16 }}\n\t\t\t\t\tonPress={() => navigation.navigate('Account')}\n\t\t\t\t>\n\t\t\t\t\t<Icon\n\t\t\t\t\t\tname=\"menu\"\n\t\t\t\t\t\tsize={35}\n\t\t\t\t\t\tstyle={{ marginLeft: 16, marginRight: 16, marginBottom: 0, bottom: 5 }}\n\t\t\t\t\t/>\n\t\t\t\t\t<Text\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tfontSize: 18,\n\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\tright: 55,\n\t\t\t\t\t\t\ttextAlign: 'right',\n\t\t\t\t\t\t\tfontWeight: 'bold',\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\twidth: 200\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{navigation.getParam('name') != null ? navigation.getParam('name').slice(0, 18) : '...'}\n\t\t\t\t\t</Text>\n\t\t\t\t</TouchableOpacity>\n\t\t\t</View>\n\t\t),\n\t\theaderLeft: () => (\n\t\t\t<View>\n\t\t\t\t<Image\n\t\t\t\t\tstyle={[{ marginBottom: -5, marginLeft: 10, width: 64, height: 64 }]}\n\t\t\t\t\tsource={require('../../assets/MISU.png')}\n\t\t\t\t/>\n\t\t\t</View>\n\t\t)\n\t});\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\terror: null,\n\t\t\tmessage: null,\n\t\t\tselectedProperties: 0,\n\t\t\trefreshing: false,\n\t\t\tloading: false,\n\t\t\tref: false,\n\t\t\trefresh: false,\n\t\t\tusageLogs: [],\n\t\t\taccessLogs: []\n\t\t};\n\t\tthis.ModalRef = React.createRef();\n\t}\n\n\t// Called when when the screen is about to load, grabs all the info to display\n\tcomponentDidMount() {\n\t\tif (this.props.sessionData != null)\n\t\t\tthis.props.navigation.setParams({\n\t\t\t\tname: this.props.sessionData.name\n\t\t\t});\n\t\tthis.onRefresh();\n\t}\n\n\t// Retrieves all the information on pull down/refresh of the app\n\tonRefresh = async () => {\n\t\tawait this.setState({ loading: true });\n\t\tawait this.setState({ refreshingUsers: true });\n\t\tconst { idToken } = this.props.sessionData;\n\t\tthis.props.getHub(idToken);\n\t\tthis.props.getDevices(idToken);\n\t\tawait this.props.getAccounts(idToken);\n\t\tthis.props.getSharedDevices(idToken);\n\t\tthis.getUsageLogs();\n\t\tthis.getAccessLogs();\n\t\tawait this.setState({ loading: false });\n\t\tawait this.setState({ refreshingUsers: false });\n\t};\n\n\tUNSAFE_componentWillReceiveProps(props) {\n\t\tthis.setState({\n\t\t\trefresh: !this.state.refresh\n\t\t});\n\n\t\tif (\n\t\t\t(!this.state.loading && props.updateInviteState.loading) ||\n\t\t\t(!this.state.loading && props.exitHubData.loading) ||\n\t\t\t(!this.state.loading && props.shareState.loading) ||\n\t\t\t(!this.state.loading && props.exitHubData.loading)\n\t\t) {\n\t\t\tthis.setState({\n\t\t\t\tloading: true\n\t\t\t});\n\t\t\t// this.props.route.params.setLoadingTrue();\n\t\t}\n\n\t\tif (\n\t\t\tthis.state.loading &&\n\t\t\t!props.shareState.loading &&\n\t\t\t!props.exitHubData.loading &&\n\t\t\t!props.updateInviteState.loading\n\t\t) {\n\t\t\tthis.setState({\n\t\t\t\tloading: false\n\t\t\t});\n\t\t\t// this.props.route.params.setLoadingFalse();\n\t\t}\n\t}\n\n\topenModal() {\n\t\tthis.ModalRef.current.snapTo(0);\n\t}\n\n\t// This is where all the components are rendered on the screen\n\trender() {\n\t\t// Display this message if there is no hub registered to you and you have no hubs you're added to.\n\t\tlet newUserScreen = null;\n\t\tlet noLogs = null;\n\t\tif (\n\t\t\t(this.props.hubInfoData.hub_email == null || this.props.hubInfoData.hub_email == '') &&\n\t\t\tthis.state.loading == false &&\n\t\t\t(this.props.sharedDevicesData == null ||\n\t\t\t\tthis.props.sharedDevicesData.devices == null ||\n\t\t\t\tthis.props.sharedDevicesData.devices.length <= 0)\n\t\t) {\n\t\t\tnewUserScreen = (\n\t\t\t\t<View style={appStyle.container}>\n\t\t\t\t\t<View style={{ width: 240, alignItems: 'center' }}>\n\t\t\t\t\t\t<AppHeaderText style={{ marginTop: 20 }}>Own a Hub?</AppHeaderText>\n\n\t\t\t\t\t\t<TouchableOpacity\n\t\t\t\t\t\t\tstyle={appStyle.regularButton}\n\t\t\t\t\t\t\tonPress={() => this.props.navigation.navigate('Account')}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<AppText>Register my Hub</AppText>\n\t\t\t\t\t\t</TouchableOpacity>\n\n\t\t\t\t\t\t<AppText style={{ marginTop: 20, fontSize: 16 }}>If you own a hub, register above.</AppText>\n\t\t\t\t\t\t<AppText style={{ marginTop: 5, fontSize: 15 }}>\n\t\t\t\t\t\t\tOtherwise, ask a Hub owner to give you access using your User ID,\n\t\t\t\t\t\t</AppText>\n\t\t\t\t\t</View>\n\t\t\t\t\t<AppText style={{ marginTop: 5, fontSize: 15 }}>\n\t\t\t\t\t\t<AppText style={{ fontWeight: 'bold' }}> {this.props.sessionData.email} </AppText>{' '}\n\t\t\t\t\t</AppText>\n\t\t\t\t</View>\n\t\t\t);\n\t\t} else {\n\t\t\tif (this.state.usageLogs.length <= 0 && this.state.accessLogs.length <= 0) {\n\t\t\t\tnoLogs = (\n\t\t\t\t\t<View style={appStyle.card}>\n\t\t\t\t\t\t<View style={[appStyle.container, { paddingBottom: 0, flex: 1 }]}>\n\t\t\t\t\t\t\t<View style={appStyle.rowLeft}>\n\t\t\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\t\t\tstyle={{ width: 30, height: 30, marginRight: 20 }}\n\t\t\t\t\t\t\t\t\tsource={require('../../assets/log.png')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<AppHeaderText style={{ fontSize: 20, marginTop: 2, marginLeft: -5 }}>\n\t\t\t\t\t\t\t\t\tNo Logs Yet...\n\t\t\t\t\t\t\t\t</AppHeaderText>\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</View>\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<View style={{ flex: 1 }}>\n\t\t\t\t<ScrollView\n\t\t\t\t\tstyle={{ flex: 1 }}\n\t\t\t\t\trefreshControl={<RefreshControl refreshing={this.state.refreshing} onRefresh={this.onRefresh} />}\n\t\t\t\t>\n\t\t\t\t\t{this.state.refreshing == false && (\n\t\t\t\t\t\t<View style={[appStyle.container, { flex: 1 }]}>\n\t\t\t\t\t\t\t{/* Display owner hub */}\n\t\t\t\t\t\t\t{this.props.hubInfoData.hub_email != null && this.props.hubInfoData.hub_email != '' && (\n\t\t\t\t\t\t\t\t<HubCard\n\t\t\t\t\t\t\t\t\tname={this.props.sessionData.name}\n\t\t\t\t\t\t\t\t\tsharedAccounts={this.props.sharedAccountsData.sharedAccounts}\n\t\t\t\t\t\t\t\t\tloading={this.state.refreshingUsers}\n\t\t\t\t\t\t\t\t\tOpenModal={this.openModal.bind(this)}\n\t\t\t\t\t\t\t\t\tnavigation={this.props.navigation}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{/* Display shared accounts*/}\n\t\t\t\t\t\t\t{this.props.sharedDevicesData.devices && Array.isArray(this.props.sharedDevicesData.devices)\n\t\t\t\t\t\t\t\t? this.props.sharedDevicesData.devices.map((device, index) => {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<HomeCard\n\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\t\tloading={\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.props.exitHubData.loading ||\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.props.updateInviteState.loading\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tsharedDevice={device}\n\t\t\t\t\t\t\t\t\t\t\t\tnavigation={this.props.navigation}\n\t\t\t\t\t\t\t\t\t\t\t\texitHub={this.props.exitHub}\n\t\t\t\t\t\t\t\t\t\t\t\tupdateInvite={this.props.updateInvite}\n\t\t\t\t\t\t\t\t\t\t\t\tIdToken={this.props.sessionData.idToken}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t: null}\n\t\t\t\t\t\t\t{/* Display Log*/}\n\t\t\t\t\t\t\t{noLogs}\n\n\t\t\t\t\t\t\t{this.state.usageLogs.length > 0 ? (\n\t\t\t\t\t\t\t\t<View style={[appStyle.container, { padding: 0, flex: 1, alignSelf: 'stretch' }]}>\n\t\t\t\t\t\t\t\t\t<TouchableOpacity\n\t\t\t\t\t\t\t\t\t\tstyle={{ alignSelf: 'stretch' }}\n\t\t\t\t\t\t\t\t\t\tonPress={() => this.props.navigation.navigate('Log')}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<LogCard type=\"Activity\" logs={this.state.usageLogs.slice(0, 5)} />\n\t\t\t\t\t\t\t\t\t</TouchableOpacity>\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t{this.state.accessLogs.length > 0 ? (\n\t\t\t\t\t\t\t\t<View style={[appStyle.container, { padding: 0, flex: 1, alignSelf: 'stretch' }]}>\n\t\t\t\t\t\t\t\t\t<TouchableOpacity\n\t\t\t\t\t\t\t\t\t\tstyle={{ alignSelf: 'stretch' }}\n\t\t\t\t\t\t\t\t\t\tonPress={() => this.props.navigation.navigate('Log')}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<LogCard type=\"Access\" logs={this.state.accessLogs.slice(0, 5)} />\n\t\t\t\t\t\t\t\t\t</TouchableOpacity>\n\t\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t</View>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Screen to show when the screen is empty */}\n\t\t\t\t\t{newUserScreen}\n\n\t\t\t\t\t{/* UI Messages */}\n\t\t\t\t\t{this.state.error && <Text style={{ color: 'red', alignSelf: 'center' }}>{this.state.error}</Text>}\n\t\t\t\t\t{this.state.message && (\n\t\t\t\t\t\t<Text style={{ color: 'black', alignSelf: 'center' }}>{this.state.message}</Text>\n\t\t\t\t\t)}\n\t\t\t\t</ScrollView>\n\t\t\t\t<ShareModal\n\t\t\t\t\tonRefresh={this.onRefresh}\n\t\t\t\t\tModalRef={this.ModalRef}\n\t\t\t\t\tsetLoadingTrue={this.props.setLoadingTrue}\n\t\t\t\t\tsetLoadingFalse={this.props.setLoadingFalse}\n\t\t\t\t\tcanEditUser={true}\n\t\t\t\t/>\n\t\t\t</View>\n\t\t);\n\t}\n\n\t// Gets the logs for the devices the user has shared\n\tgetUsageLogs = async () => {\n\t\tawait fetch('https://c8zta83ta5.execute-api.us-east-1.amazonaws.com/test/getusagelogs', {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\tAuthorization: 'Bearer ' + this.props.sessionData.idToken\n\t\t\t}\n\t\t})\n\t\t\t.then((response) => response.json())\n\t\t\t.then((data) => {\n\t\t\t\t//console.log(\"%j\", \"Usage Logs\", data.message);\n\t\t\t\tif (data.message.length > 0) {\n\t\t\t\t\tvar sortedLogs = data.message.sort((a, b) =>\n\t\t\t\t\t\ta.date < b.date ? 1 : a.date === b.date ? (a.time < b.time ? 1 : -1) : -1\n\t\t\t\t\t);\n\t\t\t\t\tthis.setState({ usageLogs: sortedLogs });\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\t//console.error('getUsageLogs error:', error);\n\t\t\t\tthis.showToast(error);\n\t\t\t\tthis.setState({ error });\n\t\t\t});\n\t};\n\n\t// Gets the logs for the access which may have been granted or revoked to the user\n\tgetAccessLogs = async () => {\n\t\tawait fetch('https://c8zta83ta5.execute-api.us-east-1.amazonaws.com/test/getaccesslogs', {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\tAuthorization: 'Bearer ' + this.props.sessionData.idToken\n\t\t\t}\n\t\t})\n\t\t\t.then((response) => response.json())\n\t\t\t.then((data) => {\n\t\t\t\t//console.log(\"%j\", \"Access Logs\", data.message);\n\t\t\t\tif (data.message.length > 0) {\n\t\t\t\t\tvar sortedLogs = data.message.sort((a, b) =>\n\t\t\t\t\t\ta.date < b.date ? 1 : a.date === b.date ? (a.time < b.time ? 1 : -1) : -1\n\t\t\t\t\t);\n\t\t\t\t\tthis.setState({ accessLogs: sortedLogs });\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\t//console.error('getAccessLogs error:', error);\n\t\t\t\tthis.showToast(error);\n\t\t\t\tthis.setState({ error });\n\t\t\t});\n\t};\n}\n\nexport default HomeScreen;\n"]},"metadata":{},"sourceType":"module"}